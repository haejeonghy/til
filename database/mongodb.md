# MongoDB

## NoSQL document database

* 데이터를 문서처럼 저장하는 database
* JSON 유사 형식으로 데이터를 문서화한다. 
* 각각의 도큐먼트는 데이터를 필드-값 형태로 가지고 있다.
* 데이터를 컬렉션이라고 하는 그룹으로 묶어서 관리한다. 
* 관계형 테이블의 레거시한 방법을 사용하지 않는 데이터 저장소

### 사용하는 경우

* 비구조적인 대용량의 데이터를 저장하는 경우
  * SQL 데이터베이스보다 자유로운 형태로 데이터를 저장할 수 있다.
  * 필요에 따라 새로운 데이터 유형을 추가할 수 있다. 
  * 정형화되지 않은 많은 양의 데이터가 필요한 경우 효과적이다.
* 클라우드 컴퓨팅 및 저장공간을 최대한으로 활용하는 경우
  * 클라우드 기반으로 쉽게 분리할 수 있도록 지원한다.
  * 수평적 확장 형태로 증설하므로 무한대로 서버를 분산시켜 DB를 증설할 수 있다. 
* 빠르게 서비스를 구축하고 데이터 구조를 자주 업데이트 하는 경우
  * 스키마를 미리 준비할 필요가 없어 개발을 빠르게 해야 하는 경우에 적합하다.
  * 빠르게 프로토타입을 출시해야 하는 경우에 적합하다.
  * 소프트웨어 버전 별로 다운타임 없이 데이터 구조를 자주 업데이트 해야 하는 경우에 효율적이다. 

## Atlas Cloud

* GUI, CLI로 데이터를 시각화, 분석, 내보내기, 빌드에 사용할 수 있다.
* 클러스터를 배포할 수 있다.
  * 클러스터
    * 인스턴스들의 모임
    * 하나의 시스템처럼 작동한다.
    * 데이터를 저장하는 서버그룹으로 여러 대의 컴퓨터를 네트워크를 통해 연결하여 하나의 단일 컴퓨터처럼 동작하도록 제작한 컴퓨터
  * 레플리카 세트
    * 단일 클러스터에서 각각의 인스턴스가 가지고 있는 동일한 복제본
    * 클러스터를 이용하여 배포할 경우 자동으로 레플리카 세트를 생성한다. 
    * 동일한 데이터를 저장하는 몇 개의 연결된 MongoDB 인스턴스의 모음
    * 데이터 사본을 저장하고 있는 인스턴스의 모음
    * 인스턴스 중 하나에 문제가 발생하더라도 데이터는 그대로 유지되고 다른 레플리카 세트의 인스턴스에 저장된 데이터로 작업이 가능하다. 
    * 동일한 데이터를 저장하는 소수의 연결된 머신
  * 인스턴스
    * 특정 소프트웨어를 실행하는 로컬 또는 클라우드의 단일 머신
    * 클라우드에서 실행되는 MongoDB 데이터베이스
* 그룹화 된 서버에 데이터를 저장한다. 

## Document

* 데이터를 필드-값 쌍으로 저장하고 구성한다.
  * 필드 : 데이터의 고유한 식별자
  * 값 : 주어진 식별자와 관련된 데이터
* 컬렉션
  * 도큐먼트로 구성된 저장소
  * 도큐먼트 간의 공통 필드가 있다.
  * 데이터베이스 당 많은 컬렉션이 있다.
  * 컬렉션 당 많은 도큐먼트가 있을 수 있다. 

## Importing, Exporting

* JSON
* 읽기 쉽고 개발자들이 사용하기 편리한 형태이다.
* 텍스트 형식이라 읽기 쉽지만 느리고 메모리 사용이 비효율적이다.
* 기본 데이터 타입만 지원하기 때문에 데이터 타입에 제약이 있다. 
* 요새는 BSON도 많이 사용한다.
  * BSON
    * 이진법에 기반을 둔 표현법
    * 메모리 사용이 효율적이며 빠르고 가볍고 유연하다.
    * 더 많은 데이터타입을 사용할 수 있다.
  
```json
{
    <field> : <value>,
    <field> : <value>,
    <field> : <value>
}
```

* Mongo DB에서는 BSON으로 저장하고 JSON으로 출력한다.
* `mongoimport`, `mongoexport`
  * JSON형식으로 데이터 가져오고 내보내기
* `mongorestore`, `mongodump`
  * BSON형식으로 가져오고 내보내기

* Export
  * `mongodump`, `mongoexport`
  * Atlas Cluster URI가 필요하다. 
    * 일반 웹의 URI와 같고 username, password, cluster 주소로 이루어져 있다. 
    * `mongoexport` 사용 시 데이터베이스 컬렉션 이름, 파일 이름까지 명시해야 한다. 
* Import
  * `mongorestore`, `mongoimport`
  * Atlas Cluster URI 사용한다. 
  * 데이터 삭제하는 drop 쿼리문은 선택적으로 사용 가능하다. 
  * 