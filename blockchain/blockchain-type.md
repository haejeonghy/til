# 공개 범위에 따른 블록 체인

![세계은행그룹의 블록체인 구분](world-bank-group-blockchain.png)

## Public Blockchain

* 퍼블릭 블록체인
* 개방형 블록체인
* 누구나 트랜잭션을 생성할 수 있다.
* 일반적으로 블록체인이라고 하면 이 퍼블릭 블록체인을 지칭한다. 
* 트랜잭션 내역이 모두에게 공개되어 네트워크에 참여한 모든 노드가 이를 상호검증하고 거래를 승인하기 때문에 신뢰도가 높다.
* 모든 참여자의 거래 기록을 남기고 이를 공유하느라 처리 속도가 느리다.
* 온전한 탈중앙화
* 누구든지 네트워크에 참여할 수 있고 원장에 대한 합의 과정에 참여할 수 있다.
* 프라이빗 블록체인에 비해 트랜잭션 비용이 높다.
* 노드 수가 많아 트랜잭션이 많으면 트랜잭션이 완료되기까지 시간이 오래걸리기도 한다.
  * 트랜잭션 수수료의 변동 폭이 크다.
* 노드들은 누구나 자유롭게 합의 과정에 참여할 수 있다.
* 누구나 원장을 읽거나 쓸 수 있다.
* 원장이 한 번 체인에 올라가면 수정할 수 없다.

## Private Blockchain

* 폐쇄형 블록체인
* 프라이빗 블록체인
* 서비스 제공자의 승인을 받아야만 참여할 수 있다.
* 주로 기업에서 활용하여 엔터프라이즈 블록체인이라고도 한다.
* 전체 시스템을 감시하는 중앙 기관이 존재한다.
  * 부분적으로 분산된 시스템을 구축할 수 있다.
* 중앙 기관이 네트워크에 대한 관리 권한을 가지낟.
* 중앙 기관은 프라이빗 블록체인에 누가 접근하는지 확인하기 위한 인증 프로세스를 가지고 있다.
* 채굴이나 트랜잭션 수수료가 매우 적거나 아예 존재하지 않기도 한다.
* 누가 합의 과정에 참여할 수 있는지 미리 결정한다.
  * 많은 노드들이 합의 과정에 참여하지 않기도 한다.
* 중앙 기관이 특정 노드만 원장을 쓸 수 있도록 지정한다.
  * 경우에 따라 중앙 기관이 블록을 삭제할 수도 있다.

### 대표적인 프라이빗 블록체인

* Hyperledger
  * 하이퍼레저
  * 리눅스 재단이 끌고 있는 오픈 소스 블록체인 프로젝트
  * 산업 간 블록체인 기술을 고도화하여 협력사 간 책임성과 투명성, 신뢰가 보장되도록 하는 것
  * 구성
    * 신원 서비스
    * 정책 서비스
    * 블록체인과 트랜잭션
    * 스마트 컨트랙트
  * plug and play 
    * 플러그 앤 플레이
    * 각 모듈에 대한 API를 제공함으로써 기존 시스템에 하이퍼레저 모듈을 이식할 수 있다.
  * 프라이빗 블록체인으로 분류된다.
  * 스마트 계약을 구현할 수 있다.
  * 기업 비즈니스를 구현하기 적합하다.
  * 중앙화된 플랫폼
  * 지원하는 프레임워크
    * 하이퍼레저 패브릭
      * 하이퍼레저 프로젝트 핵심
    * 하이퍼레저 아로하
    * 하이퍼레저 소투스
    * 하이퍼레저 인디
    * 하이퍼레저 버로우
* R3
  * 블록체인을 금융 산업에 적용하고 실행하는 플랫폼을 구현하는 블록체인 컨소시엄
  * 기존 블록체인 플랫폼의 단점
    * 금융 산업에 적용하기에 지나치게 공개적이다.
    * 확장성에 한계가 있다. 
    * 법적 책임이 모호해진다.
    * 결제의 완결성이 보장받지 못하는 환경이다.
  * R3는 퍼블릭 블록체인의 한게를 보완하여 금융 산업에서 적용할 수 있는 블록체인 기술 및 플랫폼인 코다 corda를 출시하였다.
* nexledger
  * 넥스레저
  * 삼성 SDS에서 개발한 프라이빗 블록체인 플랫폼
  * 금융뿐만 아니라 다양한 산업에서 범용적으로 사용할 수 있는 기업용 블록체인 플랫폼
  * BaaS를 구독하여 별도의 인프라를 구축하지 않아도 쉽게 기업용 블록체인을 사용할 수 있도록 한다.
  * 블록체인 기술 API를 자체 제공하여 넥스레저 플렛폼 위에 원하는 기술 API를 이식할 수 있다.

### Hyperledger Fabric

* 하이퍼레저 패브릭
* 대표적인 프라이빗 블록체인 플랫폼
* 분산 원장 솔루션을 제공하는 플랫폼
* 기밀성, 탄력성, 유연성 및 확장성을 제공한다.
* 다른 하이퍼레저 기술을 플러그 앤 플레이 방식으로 지원하는 유연하고 탄력적인 아키텍처를 제공한다.
* 블록체인적 특징
  * 프라이버시와 기밀성
    * channel 채널이라고 불리는 제한된 메시지 경로를 제공한다.
    * 네트워크의 특정 하위 노드 집합에 트랜잭션 프라이버시와 기밀성을 보장한다.
    * 트랜잭션, 노드, 채널정보 등 채널에 있는 데이터는 채널에 대한 접근 권한이 없으면 열람할 수 없다.
    * 서로 다른 이해관계를 가진 기업들이 동일한 허가형 네트워크에서 공존할 수 있도록 해준다.
  * 효율적인 처리
    * 네트워크에 동시성과 병렬성을 제공하기 위해 트랜잭션 실행은 트랜잭션 정렬 및 커밋과 분리된다.
    * 네트워크 노드들은 노드 유형에 따라 이러한 액션을 수행하는 역할이 정해져있다.
    * 동시적 실행은 각 노드의 처리 효율성을 높이고 트랜잭션 전달을 가속화한다.
  * 체인 코드
    * 이더리움과 같은 분산 플랫폼에 있는 스마트컨트랙트에 해당한다.
    * 자산(현실 세계의 객체 표현)과 이러한 자산을 변경하기 위한 트랜잭션 명령(비즈니스 로직)을 인코딩하는데 사용한다.
  * 모듈식 설계
    * 하이퍼레저 패브릭은 모듈식 아키텍쳐 구현하여 네트워크 설계자에게 기능적 선택권을 제공한다.
      * 식별, 정렬(합의), 암호화에 대한 특정 알고리즘을 모든 하이퍼레저 패브릭 네트워크에 연결할 수 있다.
* 주요 개념
  * peer
    * 피어
    * 블록체인 네트워크의 기본 요소
    * 원장과 스마트 컨트랙트를 호스팅하는 노드
    * 네트워크와의 상호작용의 시작점
    * 어플리케이션이 체인코드(스마트 컨트랙트)를 실행하여 쿼리를 하거나 원장을 업데이트 하도록 한다.
    * 네트워크 각 피어에는 디지털 인증서가 할당된다.
      * 피어가 참여하는 채널에 해당 피어를 식별하도록 해준다.
      * 이 방식으로 피어는 각 채널에서 다양한 권한을 가질 수 있다.
    * 기본적으로 동일하지만 네트워크에서 여러 역할을 수행할 수 있다.
      * committing peer
        * 커밋 피어
        * 채널의 모든 피어 노드는 커밋 피어이다.
        * 생성된 트랜잭션 블록을 수신하고 블록이 네트워크에 의해 검증되면 추가 작업을 통해 원장의 사본을 커밋한다.
      * endorsing peer
        * 보증 피어
        * 스마트 컨트랙트를 체결한 모든 피어는 보증 피어가 될 수 있다.
        * 보증 피어가 되기 위해서는 (트랜잭션 보증 과정에 참여하는) 디지털 서명된 트랜잭션 응답을 생성하는 어플리케이션에 의해 실행되어야 한다.
  * channel
    * 채널
    * 하이퍼레저 패브릭 채널은 둘 이상의 특정 네트워크 노드 간의 통신을 위한 프라이빗 서브넷으로 프라이빗 트랜잭션을 수행하기 위한 목적으로 사용된다.
    * 멤버(orgs), 공유 원장, 체인코드 어플리케이션 및 정렬 서비스 노드에 의해 정의된다.
    * 네트워크 모든 트랜잭션은 채널에서 실행된다.
    * 각 당사자는 해당 채널에서 트랜잭션을 수행하기 위해 인증을 거쳐야 한다.
    * 채널에 참여하는 각 피어는 MSP(membership service provider)가 제공하는 고유한 식별자를 가진다.
    * 각 피어를 해당 채널과 서비스에 인증한다.
* 스마트 컨트랙트와 체인 코드
  * 스마트 컨트랙트
    * smart contract
    * 원장에 추가되는 새로운 데이터를 생성하는 실행 가능한 로직을 정의한다.
    * 전역 상태에 포함된 비즈니스 객체의 상태를 변경시키는 트랜잭션 로직을 정의한다. 
    * 트랜잭션을 관리한다.
  * 체인코드
    * 블록체인 네트워크에 배포하기 위해 패키징된 스마트 컨트랙트의 집합
    * 체인코드는 스마트 컨트랙트를 배포하기 위해 패키징하여 관리한다.
    * 아키텍트나 개발자가 하나의 블록체인 네트워크 안에 있는 서로 다른 조직 간 공유되어야 하는 데이터와 비즈니스 프로세스를 정의한다.
  * 보증
    * endorsement
    * 모든 체인코드에는 모든 스마트 컨트랙트에 적용되는 관련 보증 정책이 있다.
      * 트랜잭션의 유효성을 위해 트랜잭션에 서명을 해야 하는 블록체인 네트워크 내 조직 의미
  * 유효한 트랜잭션
    * 스마트 컨트랙트는 블록체인 네트워크 내 조직이 소유한 피어 노드에서 실행된다.
    * 트랜잭션 제안서 transaction proposal라 불리는 입력 파라미터의 집합을 취하여 스마트 컨트랙트의 프로그램 로직과 함께 사용하여 원장을 읽고 쓴다.
    * 전역 상태의 변화는 읽은 상태와 트랜잭션이 유효할 경우 기록될 새로운 상태를 모두 포함하는 읽기-쓰기 집합으로 구성된 트랜잭션 제안 응답으로 캡쳐된다.
    * 전역 상태는 스마트 컨트랙트가 실행될 때 변하지 않는다.
    * 트랜잭션이 최종적으로 유효해지면 업데이트된다.
    * 네트워크의 모든 피어 노드에 배포되는 트랜잭션 검증
      1. 보증 정책에 따라 지정된 조직에서 서명된 거래인지 확인한다.
      2. 전역 상태의 현재 값이 보증 피어 노드에 의해 서명됐을 때의 트랜잭션의 읽기 집합과 일치하는지 확인한다.
      * 트랜잭션이 두 과정을 모두 통과하면 유효한 트랜잭션이 된다.
      * 유효한 트랜잭션과 유효하지 않은 트랜잭션은 모두 블록체인 이력에 추가하지만 유효한 트랜잭션만이 전역 상태를 업데이트한다.
* 이더리움과 하이퍼레저 패브릭의 차이점
  * 플랫폼의 목적
    * 하이퍼레저 패브릭 
      * EVM위에서 스마트 컨트랙트를 실행하는 하나의 목적으로 만들어졌다.
      * dApp 분산형 어플리케이션을 배포할 수 있다.
      * 사람들의 다양한 요구에 맞는 개인화된 블록체인을 개발할 수 있게 해준다.
        * 하이퍼레저
          * 고성능과 신뢰성이 높은 블록체인 개발을 위한 산업 전반의 협업을 가속화하기 위해 도입되었다.
      * B2B 플랫폼
    * 이더리움
      * B2C
  * 작동 방식
    * 이더리움
      * 퍼블릭 브록체인
      * 누구나 블록체인 네트워크에 접근할 수 있다.
      * 네트워크에 접근할 때 허가를 받을 필요가 없다.
    * 하이퍼레저 패브릭
      * 프라이빗 블록체인
      * 허가된 사용자만이 네트워크에 참여할 수 있다.
      * 사전에 정의된 허가 받은 참여자 커뮤니티로 제한되어 있다. 
  * 피어 역할
    * 이더리움
      * 각 피어마다 역할이 있다.
      * 트랜잭션이 완료되면 이를 위해 여러 노드가 참여해야 하므로 확장성, 프라이버시, 효율성 등의 문제가 발생할 수 있다.
    * 하이퍼레저
      * 네트워크 내에 각 피어에게 트랜잭션을 수행하기 위해 정보를 제공할 필요가 없는 DLT distributed ledger technology를 제공한다.
  * 기밀성
    * 이더리움
      * 퍼블릭 네트워크이기 때문에 블록체인 네트워크에 기록된 모든 트랜잭션에 누구든지 접근할 수 있다.
    * 하이퍼레저
      * 허가형 프라이빗 네트워크이기 때문에 허가된 멤버만 트랜잭션에 접근할 수 있다.
  * 합의 매커니즘
    * 이더리움
      * 모든 노드가 합의에 도달해야 하는 PoS 합의 알고리즘을 사용한다.
    * 하이퍼레저 패브릭
      * 다른 종류의 합의 알고리즘을 사용한다.
      * 아예 합의를 하지 않거나, 다양한 합의 프로토콜 중 하나를 선택할 수 있다.
  * 프로그래밍 언어
    * 이더리움 자체 언어인 솔리디티를 사용한다.
    * 하이퍼레저는 Go 언어를 사용한다.

## Consortium Blockchain

* 동일한 목적이나 가치를 가지고 있는 다수의 기업과 단체들이 하나의 컨소시엄을 구성하고 그 안에서 작동하도록 만든 블록체인
* 프라이빗 블록체인의 한 형태
* 별도로 구별하여 하이브리드 블록체인으로 분류하기도 한다.
  * Hybrid blockchain
  * 퍼블릭 블록체인과 프라이빗 블록체인을 서로 연결하거나 두 특징을 섞은 혼합형 블록체인 형태
  * 퍼블릭 블록체인과 프라이빗 블록체인이 가지고 있는 단점을 보완하고 장점을 최대한으로 끌어올릴 수 있도록 한다.
* 퍼블릭 블록체인과 프라이빗 블록체인의 중간 형태
* 중앙 관리자에 의해 승인받은 참여자만이 블록 생성에 참여할 수 있는 프라이빗 블록체인과 유사하다.
* 같은 목적을 가지고 있는 여러 기관이 하나의 컨소시엄을 구성하여 공정성과 확장성을 보완한다. 
* 다수 참여자의 협의가 필요한 분야에서는 컨소시엄 블록체인이 효과적이다.
* 기관 간에 직접 거래함으로써 제 3자에 대한 거래 수수료를 줄이고 거래 시간을 단축할 수 있다. 
* Hyperledger fabric
  * 하이퍼레저 패브릭
  * 리눅스 재단이 주도하고 IBM이 만들었다. 