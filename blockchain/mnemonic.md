# Mnemonic

* 니모닉
* 결정적 지갑에서 난수를 12개의 영단어로 인코딩한 영단어 그룹으로, BIP39에서 제안 된다.
* 니모닉 코드 단어의 경우 사용자가 기억하고 사용하기 쉬운 형태로 구성되어 있다.
  * 기존의 시드 키는 숫자와 문자로 구성된 난수이기 때문에 사용자가 기억하기 어렵다.

## 니모닉 코드 단어

* 결정적 지갑의 난수를 인코딩한 영단어 시퀀스
* 결정적 지갑을 사용하는 지갑 어플리케이션에서는 사용자가 지갑을 생성하면, 해당 지갑에서 만든 난수로부터 영단어 시퀀스를 만들어 사용자에게 제공한다.
  * 이 단어 시퀀스에서 시드 키를 생성한다.
* 사용자가 이 단어 시퀀스를 기억하고 있으면 호환되는 다른 지갑 어플리케이션에서도 시드 키 및 파생된 모든 비밀 키를 복구할 수 있다.
* 장점
  * 16진수의 난수로 구성된 시드 키와 비교했을 때, 니모닉 단어는 사용자에게 익숙한 영단어 목록이기 때문에 사용자가 쉽게 읽을 수 있고, 사용자가 받아적기 쉽다.
    * 사용자에게 편리함을 제공한다.

## 니모닉 단어 생성 순서

1. 128bit 또는 256bit 길이의 난수를 생성한다.
2. 난수를 SHA-256 알고리즘으로 해싱하고, 해시값에서 (시드 키의 길이) / 32 만큼을 떼어낸다.
   1. 난수의 길이가 128bit라면, 해시값에서 128 / 32 인 4bit를 앞에서부터 떼어내 체크섬으로 만든다.
   * 체크섬(Checksum): 어떤 일련의 데이터에 오류가 존재하는 지 확인하기 위한 검사용 데이터
3. 체크섬을 난수의 뒤에 붙인다.
4. 체크섬을 붙인 난수를 11bit 단위로 잘라낸다.
5. 각 11bit의 단어를 사전에 정의된 단어로 치환한다.
6. 각 11bit의 순서를 유지하여 일련의 니모닉 코드를 만든다.

## 시드 생성

* BIP39에서는 니모닉 단어로부터 시드 키를 생성한다.
  * 생성된 시드는 결정적 지갑을 구축하고 비밀 키를 생성하는 데 사용된다.
  * 시드 키를 생성할 때는 PBKDF2 함수를 사용한다.
    * PBKDF2는 키 스트레칭 함수의 한 종류
* 솔팅(Salting)과 키 스트레칭
  * 솔팅
    * 원본 데이터에 임의의 문자열인 솔트(Salt)를 추가하여 해싱하는 방식
      * 솔팅 방식으로 비밀번호를 암호화하여 데이터베이스에 보관하면, 해커가 솔트가 무엇인지 알지 못하는 이상 레인보우 테이블의 해시값과 데이터베이스의 해시값을 비교해도 원본 비밀번호를 알 수는 없다.
    * 레인보우 테이블 공격 방어
      * 데이터베이스에 로그인 정보를 저장할 때, 비밀번호를 그대로 저장하면 데이터베이스를 해커가 해킹했을 때 비밀번호가 바로 노출된다.
      * 일반적으로 데이터베이스에 비밀번호를 저장할 때는 해시함수를 사용해 암호화하여 저장한다.
      * 레인보우 테이블 공격의 위험이 있다.
        * 해시 함수는 동일한 입력에 대해서는 항상 같은 값을 출력한다.
          * 다른 사용자와 비밀번호가 같은 경우, 해시값도 같다.
          * 해커들은 자주 쓰이는 비밀번호와 비밀번호의 해시값을 가지고 있다가 레인보우 테이블에 있는 해시값과 데이터베이스에 저장된 해싱된 비밀번호를 비교해서 찾을 수 있다.
      * 해시 함수는 연산 속도가 빠르기 때문에, 무차별 대입 공격을 당할 수도 있다.
      * 해시값을 비교해도 원본 비밀번호를 알 수 없도록 해야한다.
  * 키 스트레칭
    * Key Stretching
    * 솔팅 방식을 여러번 반복하는 것
    * 솔팅의 결과값을 다시 솔트함수의 입력값으로 하여 다시 솔팅을 하고, 이 과정을 반복
      * 사용자가 입력한 비밀번호는 예측하기 쉬운 경우가 많은데, 키 스트레칭은 이러한 예측을 더욱 어렵게한다.

## BIP39에서의 시드 생성 방법

* BIP39에서는 키 스트레칭 함수인 PBKDF2 함수를 사용한다.
1. PBKDF2 함수에 니모닉 코드를 입력한다.
2. PBKDF2에 솔트를 입력한다. 
   1. 솔트는 문자열 "Mnemonic"에 임의의 암호문을 붙인 형태이다.
3. PBKDF2 함수는 입력받은 니모닉 코드와 솔트로 HMAC-SHA512로 2048번 해싱하여 512bit의 값을 만들어내며, 이 값이 시드 키가 된다.

