# Hashing

* 해싱
* 다양한 크기의 입력값을 고정된 크기의 출력값으로 생성해 내는 과정

## 해시 함수

* 어떠한 크기의 입력이 들어와도 동일한 크기의 출력을 뱉는 함수
* 여러 종류의 해시 함수가 존재
  * 암호 해시 함수는 블록체인 및 다양한 분산 시스템에 데이터 무결성과 보안을 보장하는 데 사용된다.
* 동작 방식
  * 다양한 크기의 입력값을 사용해 고정된 크기의 출력값을 생성
  * 예
    * SHA-256 알고리즘은 어떤 입력값을 넣어도 256 비트 길이의 값을 출력하며, SHA-1은 160 비트 길이의 값을 출력

## 블록체인에서 해싱의 역할

* 암호 해시 함수는 메시지 인증, 디지털 서명 등 보안 어플리케이션에서 사용될 수 있다.
* 암호화폐 프로토콜에서 가장 중요한 기술 중 하나
* 사용자에게 익명성을 보장하고, 트랜잭션을 하나로 연결 및 압축하며, 블록을 연결하는 동시에 그 무결성을 보장하는 역할
* 해시값을 사용해 익명성 보장
  * 공개키를 해싱한 값을 지갑 주소로 사용하여 거래를 익명화할 수 있다. 
  * 트랜잭션 기록에는 해시값으로 암호화된 지갑 주소와 송금 및 잔액을 확인할 수 있을 뿐, 해당 지갑의 주인이 누구인지 파악할 수는 없다.
* 무결성 검증
  * 블록체인에서 해시 함수를 사용해 무결성을 검증하는 경우
    * 이전 블록의 값을 해싱한 값을 사용해 이전 블록을 가리킨다.
      * 만약 이전 블록을 해싱한 값이 달라진 경우 해당 블록 또는 가리키고 있던 이전 블록에 위변조가 일어났음을 알 수 있습니다.
    * 블록에 저장된 모든 트랜잭션을 머클 트리 알고리즘을 사용해 하나의 해시값으로 저장한다.
      * 만약 트랜잭션이 하나라도 변한 경우, 블록에 저장된 해시값도 변경된다.
  * 이러한 방식은 모든 데이터를 대조할 필요 없이, 고정된 크기의 해시값을 비교하면 된다.
    * 많은 양의 데이터를 저장하거나 기억할 필요 없이 무결성을 검증할 수 있다.
* 해시값을 사용해 채굴 노드를 정함
  * 최초의 블록체인 암호화폐인 비트코인에서는 PoW(작업 증명) 방식을 사용해 어떤 노드가 블록을 만들지 정한다. 
  * 작업 증명 방식에서는 특정 조건을 만족하는 해시값을 만족하기위해 입력값인 논스(Nonce)를 찾아야 한다. 
  * 이를 가장 먼저 찾는 노드에게 블록을 채굴할 권한을 주며 채굴에 대한 보상으로 비트코인을 제공한다.

## 암호 해시 함수

* 블록체인에서 사용되는 해시 함수는 단방향 알고리즘을 사용하고, 입력값이 조금만 달라져도 아예 다른 형태로 변한다.
  * 해싱된 값을 이용하여 기존의 값을 찾기란 매우 어렵다.
  * 해시 함수는 일방향 일반적으로 암호 해시 함수를 복호화하기 위해서는 수많은 무차별 대입을 시도해야한다.
* 충돌
  * 서로 다른 입력값을 해시 함수에 넣었는데 동일한 출력값을 내뱉는 경우
  * 시스템에 심각한 위협이 될 수 있기 때문
  * 해시 함수를 만들 때 가장 중요한 요소 중 하나
* 암호 해시 함수의 안전성을 평가하는 요소
  * 충돌 저항성
    * 어떤 해시 함수가 충돌하는 서로 다른 두 입력값을 가지고 있는지 발견되지 않은 상태
    * 해시 함수의 입력값은 그 길이와 종류가 무한하지만, 입력값은 유한하기 때문에 누군가가 충돌하는 두 입력값을 발견할 가능성도 있다.
    * 해시 함수의 충돌을 발견할 가능성은 매우 적다.
      * 돌이 없는 해시 함수는 존재하지 않다.
      * 충돌 저항성이 있다고 간주되는 해시 함수는 존재한다.
      * 이론적으로 양자 컴퓨터를 사용하게 된다면, 계산 성능을 획기적으로 늘리는 것이 가능하기 때문에 2^256 개의 가능성을 일일이 대입하는 것이 어렵지 않을 것이다.
  * 역상 저항성
    * 어떤 해시 함수가 특정한 값을 출력하는 입력값을 찾을 확률이 매우 낮을 경우 의미
    * 단방향 함수의 성질과 연관
      * 단방향 함수
        * 입력값을 통해 출력값을 얻을 수는 있지만, 출력값을 통해 입력값을 얻을 수는 없는 함수
    * 패스워드에 대한 진위성을 검증할 때도 패스워드 원문을 비교하지 않는다.
    * 패스워드를 해싱한 값을 사용하여 패스워드가 노출되는 것을 방지한다.
  * 제2 역상 저항성
    * 충돌 저항성과 역상 저항성이 복합적으로 작용한 경우
    * A라는 입력값의 해시값과 동일한 해시값을 내는 B 입력값을 누군가가 알고 있지 않은 경우
      * B 입력값을 누군가가 발견한 경우 제2 역상 공격이 가능
    * A 입력값을 통해 A' 라는 해시값이 나왔을 때, A' 해시값을 출력하게 만드는 B 입력값을 찾는 것
    * 충돌 저항성이 전제